package ai.narrativetrace.clarity;

import java.util.Set;
import java.util.stream.Collectors;
import java.util.stream.Stream;

/** Classifies verbs as domain-specific, generic, or boolean prefixes for method name scoring. */
public final class VerbDictionary {

  public enum Category {
    DOMAIN,
    STANDARD,
    GENERIC,
    BOOLEAN_PREFIX,
    UNKNOWN
  }

  public record Result(Category category, double score) {}

  // --- Domain verbs organized by industry / technical domain ---

  // Finance & Banking
  private static final Set<String> FINANCE =
      Set.of(
          "accrue",
          "amortize",
          "balance",
          "bill",
          "borrow",
          "budget",
          "capitalize",
          "charge",
          "compound",
          "consolidate",
          "credit",
          "debit",
          "deposit",
          "depreciate",
          "disburse",
          "earn",
          "encumber",
          "expense",
          "finance",
          "forfeit",
          "fund",
          "hedge",
          "hold",
          "invest",
          "invoice",
          "lend",
          "levy",
          "liquidate",
          "lower",
          "margin",
          "mature",
          "monetize",
          "negotiate",
          "net",
          "owe",
          "pay",
          "pledge",
          "prorate",
          "raise",
          "rebalance",
          "reconcile",
          "redeem",
          "refund",
          "reimburse",
          "remit",
          "repay",
          "settle",
          "spend",
          "subsidize",
          "tax",
          "trade",
          "transact",
          "transfer",
          "underwrite",
          "vest",
          "void",
          "waive",
          "withdraw",
          "collateralize",
          "originate",
          "prepay",
          "securitize",
          "short",
          "chargeoff",
          "impair",
          "reprice",
          "revalue",
          "writeoff",
          "shortsell");

  // E-Commerce & Retail
  private static final Set<String> ECOMMERCE =
      Set.of(
          "auction",
          "backorder",
          "bid",
          "browse",
          "bundle",
          "buy",
          "cancel",
          "checkout",
          "confirm",
          "discount",
          "exchange",
          "finalize",
          "fulfill",
          "order",
          "preorder",
          "prepare",
          "price",
          "purchase",
          "quote",
          "rate",
          "restock",
          "sell",
          "upsell",
          "crosssell",
          "merchandise",
          "markdown",
          "upsize",
          "abandon",
          "reserve",
          "ship",
          "refund",
          "reprice",
          "dropship",
          "resell");

  // Healthcare & Medical
  private static final Set<String> HEALTHCARE =
      Set.of(
          "administer",
          "admit",
          "consent",
          "diagnose",
          "discharge",
          "dose",
          "examine",
          "hospitalize",
          "immunize",
          "inoculate",
          "prescribe",
          "refer",
          "rehabilitate",
          "resuscitate",
          "screen",
          "sedate",
          "sterilize",
          "treat",
          "triage",
          "vaccinate",
          "auscultate",
          "catheterize",
          "defibrillate",
          "dispense",
          "extubate",
          "incise",
          "intubate",
          "palpate",
          "suture",
          "transfuse",
          "ventilate");

  // Hospitality & Travel
  private static final Set<String> HOSPITALITY =
      Set.of(
          "accommodate",
          "book",
          "cater",
          "checkin",
          "lodge",
          "rebook",
          "reserve",
          "seat",
          "upgrade",
          "vacate",
          "checkout",
          "downgrade",
          "housekeep",
          "overbook",
          "reconfirm",
          "ticket",
          "upsell",
          "waitlist");

  // Telecommunications
  private static final Set<String> TELECOM =
      Set.of(
          "broadcast",
          "buffer",
          "dial",
          "forward",
          "handoff",
          "multiplex",
          "mute",
          "page",
          "patch",
          "ping",
          "relay",
          "roam",
          "route",
          "signal",
          "transmit",
          "tunnel",
          "deprovision",
          "demodulate",
          "handover",
          "modulate",
          "originate",
          "provision",
          "redial",
          "shape",
          "terminate",
          "throttle");

  // Gaming
  private static final Set<String> GAMING =
      Set.of(
          "aggro",
          "ban",
          "buff",
          "craft",
          "debuff",
          "dodge",
          "equip",
          "grab",
          "grind",
          "heal",
          "kick",
          "loot",
          "matchmake",
          "nerf",
          "parry",
          "quest",
          "rank",
          "respawn",
          "revive",
          "score",
          "slay",
          "spawn",
          "summon",
          "teleport",
          "wield",
          "forfeit",
          "levelup",
          "lobby",
          "match",
          "prestige",
          "queue",
          "reroll",
          "spectate");

  // Logistics & Supply Chain
  private static final Set<String> LOGISTICS =
      Set.of(
          "backlog",
          "consign",
          "coordinate",
          "deliver",
          "dispatch",
          "expedite",
          "freight",
          "inventory",
          "label",
          "manifest",
          "pack",
          "palletize",
          "pick",
          "prioritize",
          "replenish",
          "reroute",
          "ship",
          "stow",
          "track",
          "unload",
          "unpack",
          "warehouse",
          "backhaul",
          "crossdock",
          "deconsolidate",
          "dock",
          "linehaul",
          "slot",
          "sort",
          "transload");

  // Insurance
  private static final Set<String> INSURANCE =
      Set.of(
          "adjust",
          "annuitize",
          "assess",
          "claim",
          "commute",
          "cover",
          "endorse",
          "exclude",
          "indemnify",
          "insure",
          "lapse",
          "litigate",
          "reinsure",
          "reinstate",
          "renew",
          "subrogate",
          "underwrite",
          "quote",
          "bind",
          "rate",
          "nonrenew",
          "rescind",
          "cancel",
          "adjudicate",
          "underpay",
          "overpay");

  // Education
  private static final Set<String> EDUCATION =
      Set.of(
          "accredit",
          "assign",
          "certify",
          "counsel",
          "enroll",
          "evaluate",
          "exempt",
          "expel",
          "grade",
          "graduate",
          "guide",
          "matriculate",
          "mentor",
          "proctor",
          "submit",
          "tutor",
          "instruct",
          "lecture",
          "remediate",
          "differentiate",
          "accommodate",
          "advise",
          "discipline",
          "readmit");

  // Real Estate & Property
  private static final Set<String> REAL_ESTATE =
      Set.of(
          "appraise",
          "broker",
          "condemn",
          "demolish",
          "escrow",
          "evict",
          "foreclose",
          "inspect",
          "lease",
          "mortgage",
          "occupy",
          "rent",
          "rezone",
          "subdivide",
          "survey",
          "zone",
          "stage",
          "relet",
          "deed",
          "title",
          "record",
          "notarize",
          "relist",
          "vacate");

  // HR & Workforce
  private static final Set<String> HR =
      Set.of(
          "compensate",
          "demote",
          "dismiss",
          "furlough",
          "hire",
          "interview",
          "lead",
          "offboard",
          "onboard",
          "promote",
          "recruit",
          "relocate",
          "retire",
          "terminate",
          "coach",
          "discipline",
          "evaluate",
          "incentivize",
          "backfill",
          "upskill",
          "reskill",
          "redeploy",
          "retain",
          "reclassify",
          "downsize",
          "rightsize",
          "reassign");

  // Security & Authentication
  private static final Set<String> SECURITY =
      Set.of(
          "authenticate",
          "authorize",
          "blacklist",
          "challenge",
          "cipher",
          "deauthenticate",
          "deauthorize",
          "decrypt",
          "deny",
          "deprovision",
          "detect",
          "elevate",
          "encrypt",
          "expire",
          "firewall",
          "grant",
          "hash",
          "impersonate",
          "intercept",
          "isolate",
          "lock",
          "obfuscate",
          "pentest",
          "quarantine",
          "redact",
          "register",
          "remediate",
          "revoke",
          "rotate",
          "sanitize",
          "scan",
          "sign",
          "suspend",
          "tokenize",
          "unlock",
          "unregister",
          "verify",
          "whitelist",
          "attest",
          "declassify",
          "harden",
          "jail",
          "sandbox",
          "sequester",
          "unseal",
          "vault",
          "allowlist",
          "blocklist");

  // DevOps & Infrastructure
  private static final Set<String> DEVOPS =
      Set.of(
          "allocate",
          "autoscale",
          "bind",
          "bootstrap",
          "cache",
          "canary",
          "clone",
          "compile",
          "compress",
          "configure",
          "containerize",
          "decommission",
          "deploy",
          "discover",
          "drain",
          "drop",
          "failover",
          "flush",
          "healthcheck",
          "host",
          "hydrate",
          "initialize",
          "inject",
          "install",
          "instrument",
          "invalidate",
          "invoke",
          "keep",
          "launch",
          "lint",
          "loadbalance",
          "migrate",
          "monitor",
          "observe",
          "orchestrate",
          "override",
          "pool",
          "probe",
          "propagate",
          "provision",
          "prune",
          "purge",
          "reboot",
          "recover",
          "refresh",
          "rehash",
          "release",
          "reload",
          "replicate",
          "resolve",
          "restart",
          "restore",
          "retry",
          "rollback",
          "scale",
          "seed",
          "serve",
          "shard",
          "shrink",
          "snapshot",
          "stack",
          "stage",
          "stash",
          "synchronize",
          "throttle",
          "tombstone",
          "trace",
          "trigger",
          "tune",
          "undeploy",
          "unpin",
          "warm",
          "wire",
          "wrap",
          "cordon",
          "evict",
          "promote",
          "rollout",
          "rollforward",
          "rollup",
          "taint",
          "untaint",
          "remount",
          "reschedule");

  // Data & Analytics
  private static final Set<String> DATA =
      Set.of(
          "aggregate",
          "anonymize",
          "backfill",
          "bin",
          "calculate",
          "capture",
          "classify",
          "cleanse",
          "cluster",
          "correlate",
          "crawl",
          "deduplicate",
          "denormalize",
          "derive",
          "downsample",
          "enrich",
          "estimate",
          "export",
          "extract",
          "feed",
          "import",
          "infer",
          "ingest",
          "interpolate",
          "link",
          "load",
          "lookup",
          "match",
          "measure",
          "merge",
          "normalize",
          "partition",
          "persist",
          "pipeline",
          "pivot",
          "populate",
          "precompute",
          "prefetch",
          "profile",
          "pseudonymize",
          "quantize",
          "sample",
          "segment",
          "serialize",
          "store",
          "summarize",
          "synthesize",
          "transform",
          "transpose",
          "traverse",
          "trim",
          "truncate",
          "unlink",
          "upsert",
          "validate",
          "bucketize",
          "featurize",
          "impute",
          "materialize",
          "repartition",
          "window",
          "rank",
          "dedupe",
          "coalesce",
          "vectorize");

  // Content & Media
  private static final Set<String> CONTENT =
      Set.of(
          "annotate",
          "archive",
          "bookmark",
          "caption",
          "censor",
          "crop",
          "curate",
          "draft",
          "dub",
          "embed",
          "feature",
          "highlight",
          "index",
          "mark",
          "moderate",
          "narrate",
          "post",
          "stream",
          "subtitle",
          "syndicate",
          "tag",
          "thumbnail",
          "transcode",
          "transcribe",
          "translate",
          "watermark",
          "factcheck",
          "geotag",
          "localize",
          "proofread",
          "publish",
          "redline",
          "serialize",
          "version",
          "voiceover");

  // Social & Community
  private static final Set<String> SOCIAL =
      Set.of(
          "befriend",
          "block",
          "comment",
          "downvote",
          "flag",
          "follow",
          "invite",
          "like",
          "mention",
          "pin",
          "react",
          "report",
          "repost",
          "share",
          "unblock",
          "unfollow",
          "upvote",
          "livestream",
          "mute",
          "quote",
          "reshare",
          "subscribe",
          "unmute",
          "unsend");

  // Messaging & Events
  private static final Set<String> MESSAGING =
      Set.of(
          "acknowledge",
          "bounce",
          "dequeue",
          "emit",
          "enqueue",
          "escalate",
          "fanout",
          "notify",
          "queue",
          "replay",
          "ack",
          "deadletter",
          "nack",
          "park",
          "publish",
          "redeliver",
          "retry",
          "settle");

  // IoT & Embedded
  private static final Set<String> IOT =
      Set.of(
          "actuate",
          "arm",
          "beacon",
          "blink",
          "calibrate",
          "disarm",
          "flash",
          "mesh",
          "pair",
          "poll",
          "sense",
          "simulate",
          "unpair",
          "commission",
          "decommission",
          "provision",
          "deprovision",
          "sample",
          "telemeter",
          "reboot",
          "sleep",
          "wake");

  // Legal & Compliance
  private static final Set<String> LEGAL =
      Set.of(
          "adjudicate",
          "amend",
          "appeal",
          "approve",
          "arbitrate",
          "attest",
          "audit",
          "codify",
          "comply",
          "depose",
          "enforce",
          "file",
          "mandate",
          "notarize",
          "petition",
          "ratify",
          "regulate",
          "reject",
          "sanction",
          "seal",
          "stipulate",
          "subpoena",
          "brief",
          "counterclaim",
          "indict",
          "litigate",
          "negotiate",
          "plead",
          "prosecute",
          "remand",
          "waive");

  // Manufacturing
  private static final Set<String> MANUFACTURING =
      Set.of(
          "assemble",
          "batch",
          "cast",
          "cure",
          "engrave",
          "extrude",
          "fabricate",
          "forge",
          "laminate",
          "machine",
          "mill",
          "mold",
          "package",
          "polish",
          "produce",
          "rivet",
          "solder",
          "stamp",
          "temper",
          "weld",
          "yield",
          "anneal",
          "braze",
          "deburr",
          "electroplate",
          "sinter",
          "tool",
          "torque",
          "diecut",
          "harden");

  // Agriculture & Food
  private static final Set<String> AGRICULTURE =
      Set.of(
          "brew",
          "compost",
          "cultivate",
          "distill",
          "distribute",
          "ferment",
          "fertilize",
          "graft",
          "graze",
          "grow",
          "harvest",
          "irrigate",
          "pasteurize",
          "plant",
          "reap",
          "ripen",
          "sow",
          "thresh",
          "cull",
          "drain",
          "mulch",
          "prune",
          "rototill",
          "spray",
          "transplant",
          "wean",
          "weed",
          "winterize");

  // Advertising & Marketing
  private static final Set<String> ADVERTISING =
      Set.of(
          "advertise",
          "attribute",
          "boost",
          "click",
          "engage",
          "funnel",
          "market",
          "nurture",
          "optimize",
          "personalize",
          "pitch",
          "retarget",
          "sponsor",
          "target",
          "activate",
          "allocate",
          "bid",
          "brand",
          "brief",
          "convert",
          "position",
          "prospect",
          "qualify",
          "remarket",
          "segment",
          "upsell",
          "acquire",
          "monetize");

  // Transportation
  private static final Set<String> TRANSPORTATION =
      Set.of(
          "arrive",
          "board",
          "charter",
          "delay",
          "depart",
          "detour",
          "disembark",
          "dock",
          "embark",
          "ferry",
          "navigate",
          "park",
          "pass",
          "schedule",
          "taxi",
          "tow",
          "berth",
          "deplane",
          "haul",
          "layover",
          "moor",
          "refuel",
          "reroute",
          "unmoor",
          "waypoint");

  // Energy & Utilities
  private static final Set<String> ENERGY =
      Set.of(
          "conserve",
          "consume",
          "curtail",
          "desalinate",
          "forecast",
          "generate",
          "harness",
          "meter",
          "ration",
          "recycle",
          "shed",
          "backfeed",
          "blackstart",
          "decarbonize",
          "deenergize",
          "derate",
          "dispatch",
          "energize",
          "island",
          "ramp",
          "redispatch",
          "wheel");

  // Blockchain & Crypto
  private static final Set<String> BLOCKCHAIN =
      Set.of(
          "airdrop",
          "bridge",
          "burn",
          "delegate",
          "farm",
          "fork",
          "govern",
          "mine",
          "mint",
          "peg",
          "stake",
          "swap",
          "unstake",
          "bond",
          "claim",
          "finalize",
          "redelegate",
          "restake",
          "slash",
          "unbond");

  // Government & Public Sector
  private static final Set<String> PUBLIC_SECTOR =
      Set.of(
          "adopt",
          "annex",
          "appropriate",
          "charter",
          "debar",
          "elect",
          "enact",
          "gazette",
          "inaugurate",
          "legislate",
          "license",
          "marshal",
          "procure",
          "promulgate",
          "ratify",
          "redistrict",
          "register",
          "rezone");

  // Pharmaceuticals & Biotechnology
  private static final Set<String> PHARMA_BIOTECH =
      Set.of(
          "aliquot",
          "assay",
          "centrifuge",
          "compound",
          "culture",
          "dilute",
          "ferment",
          "formulate",
          "incubate",
          "inoculate",
          "lyophilize",
          "pipette",
          "sequence",
          "synthesize",
          "titrate",
          "validate");

  // Customer Support & CRM
  private static final Set<String> SUPPORT_CRM =
      Set.of(
          "acknowledge",
          "categorize",
          "deescalate",
          "deflect",
          "escalate",
          "handoff",
          "prioritize",
          "queue",
          "reassign",
          "reopen",
          "reroute",
          "resolve",
          "snooze",
          "triage",
          "unassign",
          "unsnooze");

  // Payments & Fintech
  private static final Set<String> PAYMENTS_FINTECH =
      Set.of(
          "authorize",
          "capture",
          "chargeback",
          "clear",
          "decline",
          "detokenize",
          "dispute",
          "fund",
          "increment",
          "preauthorize",
          "present",
          "reauthorize",
          "reconcile",
          "refund",
          "reverse",
          "settle",
          "tokenize",
          "void");

  // Media AdTech
  private static final Set<String> MEDIA_ADTECH =
      Set.of(
          "bid",
          "brandlift",
          "cap",
          "flight",
          "geofence",
          "impress",
          "pace",
          "pixel",
          "retarget",
          "remarket",
          "segment",
          "sponsor",
          "target",
          "traffic");

  @SuppressWarnings("PMD.UnusedPrivateField")
  private static final Set<String> DOMAIN_VERBS =
      Stream.of(
              FINANCE,
              ECOMMERCE,
              HEALTHCARE,
              HOSPITALITY,
              TELECOM,
              GAMING,
              LOGISTICS,
              INSURANCE,
              EDUCATION,
              REAL_ESTATE,
              HR,
              SECURITY,
              DEVOPS,
              DATA,
              CONTENT,
              SOCIAL,
              MESSAGING,
              IOT,
              LEGAL,
              MANUFACTURING,
              AGRICULTURE,
              ADVERTISING,
              TRANSPORTATION,
              ENERGY,
              BLOCKCHAIN,
              PUBLIC_SECTOR,
              PHARMA_BIOTECH,
              SUPPORT_CRM,
              PAYMENTS_FINTECH,
              MEDIA_ADTECH)
          .flatMap(Set::stream)
          .collect(Collectors.toUnmodifiableSet());

  private static final Set<String> STANDARD_VERBS =
      Set.of(
          "create",
          "find",
          "delete",
          "update",
          "convert",
          "parse",
          "render",
          "format",
          "filter",
          "sort",
          "send",
          "receive",
          "publish",
          "subscribe",
          "save",
          "remove",
          "add",
          "insert",
          "select",
          "fetch",
          "read",
          "write",
          "open",
          "close",
          "start",
          "stop",
          "build",
          "check",
          "count",
          "compare",
          "copy",
          "move",
          "clear",
          "reset",
          "enable",
          "disable",
          "show",
          "hide",
          "attach",
          "detach",
          "connect",
          "disconnect",
          "encode",
          "decode",
          "map",
          "reduce",
          "collect",
          "group",
          "flatten",
          "wrap",
          "unwrap",
          "log",
          "print",
          "display",
          "list",
          "search",
          "query",
          "test",
          "assert",
          "throw",
          "catch",
          "await",
          "join",
          "split",
          "replace",
          "append",
          "prepend",
          "push",
          "pop",
          "peek",
          "poll",
          "put",
          "take",
          "offer",
          "drain",
          "fill",
          "empty",
          "notify",
          "listen",
          "watch",
          "emit",
          "on",
          "off",
          "toggle");

  private static final Set<String> GENERIC_VERBS =
      Set.of(
          "get", "set", "process", "handle", "execute", "do", "run", "perform", "manage", "apply",
          "make", "call", "use", "go", "work", "try", "begin", "end", "init", "setup", "cleanup");

  private static final Set<String> BOOLEAN_PREFIXES =
      Set.of(
          "is",
          "has",
          "can",
          "should",
          "was",
          "will",
          "contains",
          "exists",
          "matches",
          "supports",
          "needs",
          "allows",
          "requires",
          "includes",
          "accepts",
          "enables",
          "equals");

  static {
    enforceNoOverlap("GENERIC_VERBS", GENERIC_VERBS, "DOMAIN_VERBS", DOMAIN_VERBS);
    enforceNoOverlap("BOOLEAN_PREFIXES", BOOLEAN_PREFIXES, "DOMAIN_VERBS", DOMAIN_VERBS);
  }

  private static void enforceNoOverlap(
      String leftName, Set<String> left, String rightName, Set<String> right) {
    var overlap = left.stream().filter(right::contains).sorted().toList();
    if (!overlap.isEmpty()) {
      throw new IllegalStateException(
          "Verb dictionary overlap between " + leftName + " and " + rightName + ": " + overlap);
    }
  }

  public Result categorize(String verb) {
    var lower = verb.toLowerCase();

    if (BOOLEAN_PREFIXES.contains(lower)) {
      return new Result(Category.BOOLEAN_PREFIX, 1.0);
    }
    if (DOMAIN_VERBS.contains(lower)) {
      return new Result(Category.DOMAIN, 1.0);
    }
    if (STANDARD_VERBS.contains(lower)) {
      return new Result(Category.STANDARD, 0.8);
    }
    if (GENERIC_VERBS.contains(lower)) {
      return new Result(Category.GENERIC, 0.4);
    }
    return new Result(Category.UNKNOWN, 0.3);
  }
}
